# Feedback Loop PoC Testing Guide

이 문서는 **1.1 플로우 모드 - Step-Action-Tool 조합 학습 검증**과 **1.2 기본 모드 - 도구 선택 패턴 학습 검증** 시나리오를 수행하는 방법을 설명합니다.

## 🎯 테스트 시나리오 개요

### 1.1 플로우 모드 - Step-Action-Tool 조합 학습 검증

**목적**: 성공한 워크플로우 패턴의 자동 학습과 재사용 능력 확인

**검증 방법**:
1. 동일한 워크플로우를 3회 연속 실행
2. 패턴 학습 발생 확인
3. 4번째 실행에서 학습된 패턴 제안 확인
4. 실행 시간 단축 및 성공률 향상 측정

**성공 기준**:
- 패턴 학습 발생: ✅ 4번째 실행에서 패턴 제안
- 성공률 95% 이상 유지
- 실행 시간 개선 확인

### 1.2 기본 모드 - 도구 선택 패턴 학습 검증

**목적**: 자연어 요청에서 최적 도구 조합 자동 추천 능력 확인

**검증 방법**:
1. 다양한 자연어 입력에 대한 도구 매핑 학습 테스트
2. 도구 효율성 학습 및 적용 검증
3. 사용자 만족도 기반 도구 조합 최적화 측정

**성공 기준**:
- 의도 파악 정확도 70% → 90% 향상
- 도구 선택 정확도 85% 이상
- 성공률 88% 이상

## 🚀 테스트 실행 방법

### 1. 자동화된 테스트 실행

```bash
cd evaluation
python feedback_poc_tester.py
```

### 2. 수동 테스트 실행

#### 2.1 플로우 모드 테스트

1. **시스템 시작**
```bash
docker-compose up --build
```

2. **프론트엔드 접속**
- http://localhost:8501 접속
- Pattern Analytics 페이지에서 기본 상태 확인

3. **워크플로우 반복 실행**
- 모드: "flow"로 설정
- 다음 메시지를 4회 연속 실행:
```
"데이터베이스에서 SHE 비상 정보 조회하고 Slack으로 알림"
```

4. **패턴 학습 확인**
- 4번째 실행에서 패턴 제안 메시지 확인
- Pattern Analytics에서 학습된 패턴 수 증가 확인

5. **성능 메트릭 확인**
- 실행 시간 비교 (1-3차 vs 4차 실행)
- 성공률 유지 확인

#### 2.2 기본 모드 테스트

1. **모드 설정**
- 모드: "basic"으로 설정

2. **다양한 시나리오 테스트**

**시나리오 1**: 긴급 알림
```
"긴급 상황을 팀에 알려줘"
```
- 예상 도구: emergency_mail, send_slack
- 3회 반복 실행하며 도구 선택 정확도 향상 확인

**시나리오 2**: 데이터 검색 및 공유
```
"프로젝트 데이터를 검색하고 팀에 공유해줘"
```
- 예상 도구: search_db, send_slack
- 3회 반복 실행하며 개선 확인

**시나리오 3**: 데이터베이스 조회 및 메일 전송
```
"데이터베이스 조회 결과를 메일로 보내줘"
```
- 예상 도구: search_db, emergency_mail
- 3회 반복 실행하며 개선 확인

3. **도구 분석 확인**
- Tool Analytics 페이지에서 사용 패턴 확인
- 개별 사용자 분석에서 개선 메트릭 확인

## 📊 결과 측정 방법

### 1. 실시간 모니터링

**Pattern Analytics Dashboard**:
- 학습된 패턴 수
- 패턴 신뢰도 점수
- 학습 효과성 비율
- 평균 성공률

**Tool Analytics Dashboard**:
- 도구 사용 빈도
- 도구별 성공률
- 개인화 선호도 점수
- 성능 트렌드

### 2. API 기반 데이터 수집

```bash
# 패턴 학습 메트릭
curl "http://localhost:8100/analytics/patterns?user_id=test_user"

# 도구 사용 분석
curl "http://localhost:8100/analytics/tools?user_id=test_user"

# 학습된 패턴 목록
curl "http://localhost:8100/patterns/learned?user_id=test_user"
```

### 3. 가시적 결과 확인

#### 플로우 모드 결과
- **패턴 제안 메시지**: "💡 학습된 패턴 제안: Pattern_X (신뢰도: 85%)"
- **실행 시간 개선**: 8.2초 → 6.1초 (25% 단축)
- **패턴 상세 정보**: Pattern Analytics에서 단계별 도구 사용 히스토리

#### 기본 모드 결과
- **도구 추천 정확도**: 시나리오별 정확한 도구 선택 비율 증가
- **사용자 만족도**: 피드백 점수 3.2 → 4.6점 향상
- **개인화 점수**: Tool Analytics에서 사용자별 선호도 점수 증가

## 🎯 성공 지표 검증

### 정량적 지표

1. **패턴 학습률**
   - 측정: 학습된 패턴 / 총 워크플로우 실행 횟수
   - 목표: 80% 이상

2. **패턴 적용 성공율**
   - 측정: 성공한 패턴 제안 / 총 패턴 제안 횟수
   - 목표: 95% 이상

3. **실행 시간 단축**
   - 측정: (기존 시간 - 최적화 시간) / 기존 시간
   - 목표: 25% 이상

4. **도구 선택 정확도**
   - 측정: 정확한 도구 선택 / 총 도구 선택 횟수
   - 목표: 85% 이상

### 정성적 지표

1. **패턴 제안의 적절성**
   - 사용자 인터페이스에서 패턴 제안 메시지 확인
   - 제안된 패턴의 단계별 적절성 평가

2. **사용자 경험 개선**
   - 반복 작업의 자동화 정도
   - 인터페이스 응답성 향상

3. **학습 품질**
   - 패턴의 일반화 가능성
   - 다양한 컨텍스트에서의 적용 가능성

## 🔧 문제 해결

### 일반적 문제

1. **패턴이 학습되지 않음**
   - 3회 이상 동일한 워크플로우 실행했는지 확인
   - 각 실행이 성공적으로 완료되었는지 확인
   - 피드백을 긍정적으로 제출했는지 확인

2. **도구 선택 정확도가 낮음**
   - 자연어 입력이 명확한지 확인
   - 여러 번 반복 실행으로 학습 효과 확인
   - 피드백을 통한 개선 확인

3. **성능 개선이 보이지 않음**
   - 충분한 학습 데이터가 축적되었는지 확인
   - 시스템 리소스 상태 확인
   - 캐싱 및 최적화 설정 확인

### 디버깅 방법

1. **로그 확인**
```bash
docker logs enhanced-agentic-ai-poc-backend-1
```

2. **데이터베이스 상태 확인**
- Pattern Analytics 대시보드에서 실시간 상태 모니터링
- API 엔드포인트를 통한 직접 데이터 조회

3. **성능 메트릭 모니터링**
- Prometheus: http://localhost:9090
- Grafana: http://localhost:3001

## 📈 예상 결과

### 성공 시나리오
- 4번째 플로우 모드 실행에서 패턴 제안 등장
- 실행 시간 25% 이상 단축
- 도구 선택 정확도 지속적 향상
- 사용자 만족도 점수 상승

### 실패 시나리오 대응
- 패턴 학습 임계값 조정
- 피드백 루프 최적화
- 도구 추천 알고리즘 개선

이 가이드를 통해 체계적으로 피드백 루프 PoC를 검증하고, 명확한 정량적/정성적 결과를 얻을 수 있습니다.